import Controller as ctrl;

contract ENS {

    @global address owner;
    @global uint64 cid;

    @global function on_deploy(address _owner){
        owner = _owner;
        __debug.print("ENS id:",__id());
    }

    @address function set_ens(uint64 _cid) export {
        __debug.assert(__transaction.get_sender() == owner, "Only owner can set_ens");
        relay@global(^_cid){
            cid = _cid;
        }
    }

    @address function invoke(string operation,uint32 amount) export {
        ctrl controller = ctrl(cid);
        __debug.assert(controller.__valid(), "Controller cid is invalid!");

        if(operation == "deposit"){
            controller.deposit(amount);
        }
        else if(operation == "withdraw")
        {
            controller.withdraw(amount);
        }
        else
        {
            __debug.assert(false,"error operation");
        }
        relay@external InvokeContract(cid,amount);
    }

}